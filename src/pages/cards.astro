---
import Layout from '@layouts/Layout.astro';
import creditCards from '@data/cards.json';
import CreditCardReact from '../components/CreditCard';// React version

import Icons from "@icons/Icons.astro";
---

<Layout>
  <header class="mb-8">
    <h1 class="text-2xl font-bold dark:text-white">Cards</h1>
    <p class="text-sm text-gray-500 dark:text-gray-400">
      Lista de tarjetas con sus estilos.
    </p>
  </header>

  <div class="flex flex-col-reverse md:grid grid-cols-2 gap-8">



 

  <ul class="flex flex-col gap-4" id="cards-list">
    {creditCards.map((producto, index) => (
      <article
        class="credit-card-selector border p-3 flex flex-col gap-2 rounded-lg shadow-md dark:bg-gray-800 dark:border-gray-700"
        data-product={JSON.stringify(producto)}
      >
        <header class="flex">
          <span class="text-sm font-medium me-2 px-2.5 py-0.5 rounded-sm bg-[#CBED94] text-black">
            {producto.Producto.Id}{producto.Producto.SubproductoId}
          </span>
          <h2 class="dark:text-white font-bold">
            {producto.Producto.SubproductoNombre}
          </h2>
        </header>
      </article>
    ))}
  </ul>

   <section  id="card-container" class="mb-8">
    <CreditCardReact
      id="Z"
      SubproductoNombre="Cordobesa dÃ©bito MasterCard"
      backgroundColor="#CFCDBA"
      textColor="#022321"
      logoColor="#D9D8C8"
      logoCordobesa="Color"
      SubproductoId="2"
      Marca="MasterCard"
      client:load
    />

  </section>

  </div>

</Layout>

<script type="module">
  const cards = document.querySelectorAll(".credit-card-selector");

  cards.forEach(card => {
    card.addEventListener("click", () => {
      const rawData = card.dataset.product;
      const json = JSON.parse(rawData);

      const event = new CustomEvent("update-card", {
        detail: json
      });

      window.dispatchEvent(event);
    });
  });
</script>